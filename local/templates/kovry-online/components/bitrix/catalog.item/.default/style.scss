@use "@scss-root/extends";
@use "@scss-root/vars";
@use "@scss-root/scoped-vars";
@use "@scss-root/container-queries" as *;

$card-width-tablet: 708px;
$card-width-desktop: 1210px;

$gallery-width-tablet: 150px;
$gallery-width-desktop: 302px;

$content-min-width-tablet: 238px;
$content-min-width-desktop: 446px;

$purchase-block-width-tablet: 200px;
$purchase-block-width-desktop: 302px;

$quantity-block-height: 60px;

$inner-offset-card-sm: 20px;
$inner-offset-card-lg: 40px;

$gap-xs: 10px;
$gap-sm: 20px;
$gap-md: 30px;
$gap-lg: 40px;

$font-size-sm: 14px;
$font-size-md: 16px;
$font-size-lg: 20px;

$line-height-sm: 20px;
$line-height-md: 24px;
$line-height-lg: 30px;

input[type="number"] {
  appearance: none;
  -moz-appearance: textfield;

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
}

.product-item-container {
  width: 100%;
  max-width: 100vw;

  container: item-container / inline-size;
}

.item {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: $gap-sm;
  padding: $inner-offset-card-sm 0;
  font-size: $font-size-md;
  line-height: $line-height-md;
  border: 1px solid var(--gray-600);

  @include container-up("item-container", $card-width-tablet) {
    display: grid;
    grid-template-columns:
      $gallery-width-tablet minmax($content-min-width-tablet, 1fr)
      $purchase-block-width-tablet;
    column-gap: $gap-lg;
    row-gap: $gap-sm;
    padding: $inner-offset-card-sm;
  }

  @include container-up("item-container", $card-width-desktop) {
    grid-template-columns:
      $gallery-width-desktop minmax($content-min-width-desktop, 1fr)
      $purchase-block-width-desktop;
    padding: $inner-offset-card-lg;
  }

  &__button {
    @extend %hover-opacity;
  }

  // Блок галереи с кнопками быстрых действий

  &__gallery-wrapper {
    position: relative;

    @include container-up("item-container", $card-width-tablet) {
      grid-column: 1/2;
      grid-row: 1/5;
    }
  }

  // -- Галерея

  &__gallery {
    padding-bottom: 10px;

    &:has(.swiper) {
      padding-bottom: 0;
    }

    @include container-up("item-container", $card-width-tablet) {
      margin-bottom: $gap-xs;
    }

    img {
      display: block;
      width: 100%;
      height: 100%;
      max-width: 302px;
      max-height: 260px;
      margin: 0 auto;
      object-fit: contain;
      object-position: center;

      @include container-up("item-container", $card-width-tablet) {
        max-width: 150px;
        max-height: 120px;
      }

      @include container-up("item-container", $card-width-desktop) {
        max-width: 302px;
        max-height: 260px;
      }
    }
  }

  // -- Кнопки быстрых действий

  &__action {
    position: absolute;
    z-index: 2;
    top: 0;
    right: $inner-offset-card-sm;
    display: flex;
    flex-direction: column;
    gap: $gap-xs;

    @include container-up("item-container", $card-width-tablet) {
      position: static;
    }
  }

  &__action-btn {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 40px;
    height: 40px;
    background-color: var(--white);
    border: 1px solid var(--gray-600);
    border-radius: 3px;

    @include container-up("item-container", $card-width-tablet) {
      display: block;
      width: 100%;
      height: auto;
      padding: 2px;
    }

    @include container-up("item-container", $card-width-desktop) {
      display: flex;
      gap: $gap-xs;
      padding: 8px;
    }
  }

  &__action-btn-icon {
    @include container-up("item-container", $card-width-tablet) {
      display: none; // вопрос
    }

    @include container-up("item-container", $card-width-desktop) {
      display: block;
    }
  }

  &__action-btn-text {
    display: none;

    @include container-up("item-container", $card-width-tablet) {
      display: inline-block;
      font-size: $font-size-sm;
      line-height: $line-height-sm;
    }
  }

  // Лейблы

  &__product-labels {
    position: absolute;
    top: $inner-offset-card-sm;
    left: $inner-offset-card-sm;
    z-index: 2;

    display: flex;
    flex-direction: column;
    gap: $gap-xs;

    max-width: 125px;

    @include container-up("item-container", $card-width-tablet) {
      position: static;
      flex-direction: row;
      flex-wrap: wrap;
      max-width: none;
      grid-column: 2/3;
      grid-row: 3/4;
    }

    @include container-up("item-container", $card-width-desktop) {
      position: absolute;
      top: $inner-offset-card-lg;
      left: $inner-offset-card-lg;

      flex-direction: column;

      grid-column: auto;
      grid-row: auto;

      max-width: 125px;
    }
  }

  // Заголовок

  &__title {
    padding: 0 $inner-offset-card-sm;
    font-weight: var(--site-base-font-weight);
    color: var(--dark);

    @extend %hover-opacity;

    &:hover,
    &:focus,
    &:active {
      color: var(--dark);
      text-decoration: none;
    }

    @include container-up("item-container", $card-width-tablet) {
      grid-column: 2/3;
      grid-row: 1/2;
      padding: 0;
      font-size: $font-size-lg;
      line-height: $line-height-lg;
    }
  }

  // Торговые предложения

  &__sku {
    @include container-up("item-container", $card-width-tablet) {
      grid-column: 2/3;
      grid-row: 2/3;
    }
  }

  &__sku-list {
    display: flex;
    flex-wrap: wrap;
    gap: $gap-xs;

    margin: 0;
    padding: 0;
    list-style-type: none;
  }

  &__sku-list-item {
    padding: 4px 10px;
    font-weight: 500;
    background-color: transparent;
    border: 1px solid var(--light);
    border-radius: 3px;

    &.selected {
      color: var(--white);
      background-color: var(--primary);
      border-color: var(--primary);
      pointer-events: none;
    }
  }

  // Блок с ценами и количеством товара

  &__purchase {
    display: flex;
    flex-direction: column;
    gap: $gap-sm;
    margin-top: auto;

    @include container-up("item-container", $card-width-tablet) {
      grid-column: 3/4;
      grid-row: 1/5;
      margin-top: 0;
    }
  }

  // -- Цены

  &__price-block {
    display: flex;
    flex-direction: column;
    gap: $gap-xs;
    padding: 0 $inner-offset-card-sm;

    @include container-up("item-container", $card-width-tablet) {
      padding: 0;
    }
  }

  &__price-label {
    display: flex;
    align-items: center;
    gap: 8px;
    width: fit-content;
    padding: 2px;
    padding-left: 8px;
    background-color: var(--warning);
    border-radius: 4px;

    @include container-up("item-container", $card-width-tablet) {
      padding-left: 4px;
      font-size: $font-size-sm;
      line-height: $line-height-sm;
    }

    @include container-up("item-container", $card-width-desktop) {
      padding-left: 8px;
      font-size: $font-size-md;
      line-height: $line-height-md;
    }

    span:last-child {
      padding: 2px 8px;
      background-color: var(--info);
      border-radius: 2px;

      @include container-up("item-container", $card-width-tablet) {
        padding: 2px 4px;
      }

      @include container-up("item-container", $card-width-desktop) {
        padding: 2px 8px;
        font-size: $font-size-md;
      }
    }
  }

  &__price-value--current {
    font-size: $font-size-lg;
    line-height: $line-height-lg;
    font-weight: 600;

    @include container-up("item-container", $card-width-tablet) {
      font-size: $font-size-md;
      line-height: $line-height-md;
    }

    @include container-up("item-container", $card-width-desktop) {
      font-size: $font-size-lg;
      line-height: $line-height-lg;
    }
  }

  &__price-value--old {
    color: var(--gray-800);
    text-decoration: line-through;

    @include container-up("item-container", $card-width-tablet) {
      font-size: $font-size-sm;
      line-height: $line-height-sm;
    }

    @include container-up("item-container", $card-width-desktop) {
      font-size: $font-size-md;
      line-height: $line-height-md;
    }
  }

  // -- Кнопки изменения количества товара и "В корзину"
  &__quantity-block {
    display: flex;

    @include container-up("item-container", $card-width-tablet) {
      flex-direction: column;
    }

    @include container-up("item-container", $card-width-desktop) {
      flex-direction: row;
    }
  }

  // ---- Кнопки изменения количества товара

  &__counter {
    display: flex;
    width: 40%;
    background-color: var(--gray-500);

    @include container-up("item-container", $card-width-tablet) {
      width: 100%;
    }

    @include container-up("item-container", $card-width-desktop) {
      width: 40%;
    }
  }

  &__quantity-btn {
    width: 42px;
    padding: 5px 16px;
    color: var(--gray-800);
    background-color: transparent;
    border: 1px solid transparent;
  }

  &__quantity-field {
    width: 100%;
    min-height: $quantity-block-height;
    padding: 5px;
    text-align: center;
    background-color: transparent;
    border: 1px solid transparent;
    pointer-events: none;
  }

  // ---- "В корзину"

  .item__add-to-cart-btn {
    width: 60%;
    min-height: $quantity-block-height;
    padding: 10px;
    text-transform: uppercase;

    @include container-up("item-container", $card-width-tablet) {
      width: 100%;
    }

    @include container-up("item-container", $card-width-desktop) {
      width: 60%;
      min-height: auto;
    }
  }

  .swiper {
    padding-bottom: 10px;

    .swiper-pagination {
      bottom: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }

  .swiper-pagination-bullet {
    width: 40px;
    height: 2px;
    background-color: var(--gray-600);
    border-radius: 2px;

    @include container-up("item-container", $card-width-tablet) {
      width: 15px;
    }

    @include container-up("item-container", $card-width-desktop) {
      width: 40px;
    }

    &-active {
      background-color: var(--primary);
    }
  }
}

// temp!
.product-item-image-original {
  width: 300px;
  height: 300px;
  display: block;
  background-size: contain;
  background-repeat: no-repeat;
}
